# 快速使用指南

## 🚀 5分钟快速开始

### 步骤 1: 配置

编辑 `config/config.yaml`:

```yaml
exchanges:
  hyperliquid:
    base_url: "https://api.hyperliquid.xyz"
    private_key: ""  # 如果要自动下单,填入你的私钥(不带0x)
    wallet_address: ""  # 可选,会自动从私钥推导
  
  lighter:
    base_url: "https://mainnet.zklighter.elliot.ai"
  
  edgex:
    base_url: "https://pro.edgex.exchange"

strategies:
  funding_arb:
    enabled: true
    pairs: ["ETH-USD", "BTC-USD"]
    min_funding_diff: 0.001  # 0.1% 价差阈值
    leverage: 2.0
    check_interval_ms: 1000  # 每秒检查一次
    execute_trades: false  # ⚠️ 设为 true 启用自动交易
  
  xp_farming:
    enabled: false  # 建议先关闭,专注套利
    target_volume_daily: 10000
    max_slippage: 0.0005
```

### 步骤 2: 运行

```bash
# 监控模式 (不会自动下单)
go run cmd/main.go
```

### 步骤 3: 观察输出

```
2025/11/24 14:20:01 Config loaded successfully
2025/11/24 14:20:01 Starting Funding Arb Strategy...
2025/11/24 14:20:01 Checking funding opportunities...
2025/11/24 14:20:01 [ETH-USD] Best Diff: 0.000087 (Threshold: 0.001000) - No Opportunity
2025/11/24 14:20:01 [BTC-USD] Best Diff: 0.000058 (Threshold: 0.001000) - No Opportunity
```

## 📊 测试 WebSocket

```bash
# 测试 EdgeX WebSocket 实时数据
go run cmd/test_ws/main.go
```

预期输出:
```
2025/11/24 14:20:01 Testing EdgeX WebSocket...
2025/11/24 14:20:01 EdgeX WebSocket connected to wss://quote.edgex.exchange/api/v1/public/ws
2025/11/24 14:20:03 EdgeX WS subscribed to channel: ticker.10000001
2025/11/24 14:20:03 EdgeX WS subscribed to channel: ticker.10000002
2025/11/24 14:20:04 Received BTC ticker data: {...}
2025/11/24 14:20:04 Received ETH ticker data: {...}
```

## 🎯 使用场景

### 场景 1: 纯监控 (推荐新手)

**配置**:
```yaml
execute_trades: false
```

**用途**:
- 学习市场
- 验证策略
- 无风险观察

**操作**:
1. 运行程序
2. 观察日志
3. 发现机会时手动下单

### 场景 2: Hyperliquid 自动化

**配置**:
```yaml
hyperliquid:
  private_key: "YOUR_PRIVATE_KEY"

execute_trades: true
```

**用途**:
- 自动套利
- 减少人工干预
- 提高执行速度

**操作**:
1. 配置私钥
2. 设置小额资金测试
3. 监控运行状态

### 场景 3: 多交易所监控 + 手动对冲

**配置**:
```yaml
execute_trades: false
```

**用途**:
- 发现跨交易所机会
- 手动在 Lighter/EdgeX 对冲
- 灵活控制

**操作**:
1. 程序发现机会
2. 手动在 Hyperliquid 下单
3. 手动在 Lighter/EdgeX 对冲

## 🔧 常见问题

### Q1: 如何获取私钥?

**Hyperliquid**:
1. 使用 MetaMask 或其他钱包
2. 导出私钥 (不带 0x 前缀)
3. ⚠️ 注意安全,不要泄露

### Q2: 程序一直显示 "No Opportunity"?

**原因**:
- 当前市场价差小于阈值 (0.1%)
- 这是正常的,大部分时间都没有机会

**解决**:
- 降低 `min_funding_diff` (如 0.0005 = 0.05%)
- 或耐心等待市场波动

### Q3: EdgeX 报错 "metadata not loaded"?

**原因**:
- 网络问题
- API 限流

**解决**:
- 检查网络连接
- 等待几秒后自动重试
- 查看日志中的详细错误

### Q4: 如何停止程序?

```bash
# 按 Ctrl+C
^C
```

程序会优雅退出,关闭所有连接。

## 📈 性能优化

### 降低延迟

1. **使用 WebSocket** (已实现 EdgeX):
```bash
# 测试 WebSocket 性能
go run cmd/test_ws/main.go
```

2. **调整检查间隔**:
```yaml
check_interval_ms: 500  # 从 1000ms 降到 500ms
```

3. **部署到云服务器**:
- 选择靠近交易所的区域
- 使用低延迟网络

### 提高准确性

1. **调整阈值**:
```yaml
min_funding_diff: 0.0008  # 降低阈值,发现更多机会
```

2. **增加交易对**:
```yaml
pairs: ["ETH-USD", "BTC-USD", "SOL-USD"]
```

## 🛡️ 安全检查清单

- [ ] 私钥已妥善保管,未提交到 Git
- [ ] API Key 仅开启交易权限,禁用提现
- [ ] 使用小额资金测试
- [ ] 设置了合理的杠杆 (≤3x)
- [ ] 定期检查仓位
- [ ] 有应急预案 (手动平仓)

## 📞 获取帮助

### 查看日志
```bash
# 运行时会自动输出到控制台
# 如需保存到文件:
go run cmd/main.go > arbitrage.log 2>&1
```

### 查看文档
- `README.md` - 项目概述
- `docs/项目完成总结.md` - 完整功能说明
- `docs/API对接总结.md` - API 详细文档
- `docs/WebSocket与下单实现计划.md` - 实现细节

### 常用命令
```bash
# 编译检查
go build ./...

# 运行测试
go test ./...

# 格式化代码
go fmt ./...

# 更新依赖
go mod tidy
```

## 🎓 下一步

1. **熟悉系统**: 运行监控模式 1-2 天
2. **小额测试**: 使用 100 USDT 测试自动下单
3. **优化参数**: 根据实际情况调整阈值
4. **扩展功能**: 根据需要添加新策略

## ⚡ 快速命令参考

```bash
# 启动主程序 (监控模式)
go run cmd/main.go

# 测试 WebSocket
go run cmd/test_ws/main.go

# 编译所有代码
go build ./...

# 查看配置
cat config/config.yaml

# 编辑配置
vim config/config.yaml
```

---

**祝交易顺利! 🚀**
